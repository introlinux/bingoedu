' Gambas class file

Property btmp As Bingo
Private $btmp As Bingo


Public Sub ButtonSalir_Click()

  Me.Close()

End

Private Function btmp_Read() As Bingo

  Return $btmp

End

Private Sub btmp_Write(Value As Bingo)

  $btmp = Value

End



Public Sub Form_Show()

  'carga el dibujo de bingo segun los datos

  'Segun las dimensiones
  'elige la plantilla



  'pone aleatoriamente los huecos negros y blanco
  '
  'rellena los datos aleatoriamente


  dibujando()

End


Public Sub dibujando()

  Dim NombreArchivo As String
  Dim hSvgImage As SvgImage

  Select Case $btmp.tamanoCuadricula
    Case "4x3"
      NombreArchivo = User.Home & "/bingoedu/" & "bingotablas4x3.svg"
    Case "5x4"
      NombreArchivo = User.Home & "/bingoedu/" & "bingotablas5x4.svg"
    Case "5x5"
      NombreArchivo = User.Home & "/bingoedu/" & "bingotablas5x5.svg"
  End Select

  Inc Application.busy
  Wait 0.05
  Exec ["inkscape", "--export-dpi=20", NombreArchivo, "--export-png=" & "/tmp/cartontemporal.png"] Wait
  Dec Application.Busy


  'con los datos iniciaels (tama√±o, numero de cuadros negros y numero de cuadros blancos
  'rellenar los datos...

  PictureBox1.Picture = Picture.Load("/tmp/cartontemporal.png")

  'actualizar la imagen... por si acaso..
  PictureBox1.Refresh()

End



Public Sub ButtonSimple_Click()

  dibujando()

End
