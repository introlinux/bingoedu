' Gambas class file

Public Sub _new()
  
End

Public Sub Form_Open()
  
  Randomize 'inicio generador aleatorio
  Labelversion.text = ("Versi√≥n") & ": " & Application.Version
  Me.Center
  Me.Title = ("Bingo Educativo")
  
  'si no existe directorio de bingoedu crearlo
  If Not Exist(User.home & "/bingoedu") Then
    Mkdir User.home & "/bingoedu"
  Endif
  
  'copiar ficheros de plantilla:
  copiarficheroplantilla()
  'copiar ficheros de musica
  copiarmusica()
  
End

Private Sub copiarficheroplantilla()
  
  Dim ListaFichero As New String[]
  Dim l As String
  
  ListaFichero.Add("bingotablas4x3.svg")
  ListaFichero.Add("bingotablas5x4.svg")
  ListaFichero.Add("bingotablas5x5.svg")
  
  For Each l In ListaFichero
    If Exist(User.home & "/bingoedu/" & l) Then 
      Kill User.home & "/bingoedu/" & l '' siempre actualiza las plantillas que tiene el programa internamente
    Endif
    
    If Exist("/tmp/" & l) Then 
      Kill "/tmp/" & l '' siempre actualiza las plantillas que tiene el programa internamente
    Endif
    
    Try Copy Application.Path & "/ModelosCarton/" & l To User.home & "/bingoedu/" & l
    Try Copy Application.Path & "/ModelosCarton/" & l To "/tmp/" & l
  Next
  
  Try Copy "cuadroBlanco.jpg" To "/tmp/cuadroBlanco.jpg"
  Try Copy "cuadroNegro.jpg" To "/tmp/cuadroNegro.jpg"
  
End

Public Sub copiarmusica()
  
  Try Copy Application.Path & "/musica/coin.mp3" To User.home & "/bingoedu/coin.mp3" 
  Try Copy Application.Path & "/musica/gong.wav" To User.home & "/bingoedu/gong.wav" 
  Try Copy Application.Path & "/musica/tap-tap-tap.wav" To User.home & "/bingoedu/tap-tap-tap.wav" 
  
End

Public Sub ButtonCrearEditar_Click()
  
  FormFicherosBingos.showmodal()
  
End

Public Sub ButtonSalir_Click()
  
  Me.Close()
  
End

Public Sub Label2_MouseDown()
  
End

Public Sub ButtonJugar_Click()
  
  FormModoJuego.ShowModal()
  
End
