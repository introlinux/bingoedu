' Gambas class file

Inherits Task

Public $rutabingo As String
Public $contenedor As ScrollView
Public $picturevisor As PictureBox

Private obs As Observer

Event PulsarBotonGaleriaImagen(ruta As String)

Public Sub main()
  
End

Public Sub cargarlistados(rutabingo As String, contenedor As ScrollView, picturevisor As PictureBox, ByRef arfile As String[])
  
  Dim p As PictureBox
  Dim nombrefichero As String
  Dim arfile2 As String[]
  
  $rutabingo = rutabingo
  $contenedor = contenedor
  
  $picturevisor = picturevisor
  
  'borra todos los archivos que empiecen por carton*
  arfile2 = Dir(User.home & "/" & "bingoedu/" & $rutabingo, "carton*", gb.file)
  arfile.Clear()
  
  For Each nombrefichero In arfile2
    If File.Ext(nombrefichero) = "png" Then 
      arfile.add(nombrefichero)
    Endif
  Next
  
  For Each nombrefichero In arfile
    p = New PictureBox($contenedor) 
    p.w = 137
    p.h = 95
    p.Picture = Picture.Load(User.home & "/" & "bingoedu/" & $rutabingo & "/mini" & nombrefichero)
    p.Stretch = True
    p.tag = User.home & "/" & "bingoedu/" & $rutabingo & "/" & nombrefichero
    obs = New Observer(p) As "observador"
    'wait 0.25' 
  Next
  
  'mostrar(0)
  
End

Public Sub observador_MouseDown()
  
  Raise PulsarBotonGaleriaImagen(Last.tag)
  
End
